{"ast":null,"code":"import { map, switchMap } from 'rxjs/operators';\nimport { of } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/fire/compat/firestore\";\nimport * as i2 from \"./auth.service\";\nexport class FirestoreBillService {\n  constructor(afs, auth) {\n    this.afs = afs;\n    this.auth = auth;\n  }\n  get userId$() {\n    return this.auth.user$.pipe(map(user => user?.uid));\n  }\n  getBills() {\n    return this.userId$.pipe(switchMap(uid => {\n      if (!uid) return of([]);\n      return this.afs.collection(`users/${uid}/bills`).valueChanges({\n        idField: 'id'\n      });\n    }));\n  }\n  addBill(bill) {\n    return this.userId$.pipe(switchMap(uid => {\n      if (!uid) return of(null);\n      return this.afs.collection(`users/${uid}/bills`).add(bill);\n    }));\n  }\n  updateBill(bill) {\n    return this.userId$.pipe(switchMap(uid => {\n      if (!uid || !bill.id) return of(null);\n      return this.afs.doc(`users/${uid}/bills/${bill.id}`).update(bill);\n    }));\n  }\n  deleteBill(billId) {\n    return this.userId$.pipe(switchMap(uid => {\n      if (!uid) return of(null);\n      return this.afs.doc(`users/${uid}/bills/${billId}`).delete();\n    }));\n  }\n  static {\n    this.ɵfac = function FirestoreBillService_Factory(t) {\n      return new (t || FirestoreBillService)(i0.ɵɵinject(i1.AngularFirestore), i0.ɵɵinject(i2.AuthService));\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: FirestoreBillService,\n      factory: FirestoreBillService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}","map":{"version":3,"names":["map","switchMap","of","FirestoreBillService","constructor","afs","auth","userId$","user$","pipe","user","uid","getBills","collection","valueChanges","idField","addBill","bill","add","updateBill","id","doc","update","deleteBill","billId","delete","i0","ɵɵinject","i1","AngularFirestore","i2","AuthService","factory","ɵfac","providedIn"],"sources":["/Users/vinithyareddy/Desktop/projects/my github projects/expense-tracker/src/app/services/firestore-bill.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { AngularFirestore } from '@angular/fire/compat/firestore';\nimport { AuthService } from './auth.service';\nimport { Bill } from '../models/bill.model';\nimport { map, switchMap } from 'rxjs/operators';\nimport { of } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class FirestoreBillService {\n  constructor(private afs: AngularFirestore, private auth: AuthService) {}\n\n  private get userId$() {\n    return this.auth.user$.pipe(map(user => user?.uid));\n  }\n\n  getBills() {\n    return this.userId$.pipe(\n      switchMap(uid => {\n        if (!uid) return of([]);\n        return this.afs.collection<Bill>(`users/${uid}/bills`).valueChanges({ idField: 'id' });\n      })\n    );\n  }\n\n  addBill(bill: Bill) {\n    return this.userId$.pipe(\n      switchMap(uid => {\n        if (!uid) return of(null);\n        return this.afs.collection<Bill>(`users/${uid}/bills`).add(bill);\n      })\n    );\n  }\n\n  updateBill(bill: Bill) {\n    return this.userId$.pipe(\n      switchMap(uid => {\n        if (!uid || !bill.id) return of(null);\n        return this.afs.doc<Bill>(`users/${uid}/bills/${bill.id}`).update(bill);\n      })\n    );\n  }\n\n  deleteBill(billId: string) {\n    return this.userId$.pipe(\n      switchMap(uid => {\n        if (!uid) return of(null);\n        return this.afs.doc<Bill>(`users/${uid}/bills/${billId}`).delete();\n      })\n    );\n  }\n}\n"],"mappings":"AAIA,SAASA,GAAG,EAAEC,SAAS,QAAQ,gBAAgB;AAC/C,SAASC,EAAE,QAAQ,MAAM;;;;AAKzB,OAAM,MAAOC,oBAAoB;EAC/BC,YAAoBC,GAAqB,EAAUC,IAAiB;IAAhD,KAAAD,GAAG,GAAHA,GAAG;IAA4B,KAAAC,IAAI,GAAJA,IAAI;EAAgB;EAEvE,IAAYC,OAAOA,CAAA;IACjB,OAAO,IAAI,CAACD,IAAI,CAACE,KAAK,CAACC,IAAI,CAACT,GAAG,CAACU,IAAI,IAAIA,IAAI,EAAEC,GAAG,CAAC,CAAC;EACrD;EAEAC,QAAQA,CAAA;IACN,OAAO,IAAI,CAACL,OAAO,CAACE,IAAI,CACtBR,SAAS,CAACU,GAAG,IAAG;MACd,IAAI,CAACA,GAAG,EAAE,OAAOT,EAAE,CAAC,EAAE,CAAC;MACvB,OAAO,IAAI,CAACG,GAAG,CAACQ,UAAU,CAAO,SAASF,GAAG,QAAQ,CAAC,CAACG,YAAY,CAAC;QAAEC,OAAO,EAAE;MAAI,CAAE,CAAC;IACxF,CAAC,CAAC,CACH;EACH;EAEAC,OAAOA,CAACC,IAAU;IAChB,OAAO,IAAI,CAACV,OAAO,CAACE,IAAI,CACtBR,SAAS,CAACU,GAAG,IAAG;MACd,IAAI,CAACA,GAAG,EAAE,OAAOT,EAAE,CAAC,IAAI,CAAC;MACzB,OAAO,IAAI,CAACG,GAAG,CAACQ,UAAU,CAAO,SAASF,GAAG,QAAQ,CAAC,CAACO,GAAG,CAACD,IAAI,CAAC;IAClE,CAAC,CAAC,CACH;EACH;EAEAE,UAAUA,CAACF,IAAU;IACnB,OAAO,IAAI,CAACV,OAAO,CAACE,IAAI,CACtBR,SAAS,CAACU,GAAG,IAAG;MACd,IAAI,CAACA,GAAG,IAAI,CAACM,IAAI,CAACG,EAAE,EAAE,OAAOlB,EAAE,CAAC,IAAI,CAAC;MACrC,OAAO,IAAI,CAACG,GAAG,CAACgB,GAAG,CAAO,SAASV,GAAG,UAAUM,IAAI,CAACG,EAAE,EAAE,CAAC,CAACE,MAAM,CAACL,IAAI,CAAC;IACzE,CAAC,CAAC,CACH;EACH;EAEAM,UAAUA,CAACC,MAAc;IACvB,OAAO,IAAI,CAACjB,OAAO,CAACE,IAAI,CACtBR,SAAS,CAACU,GAAG,IAAG;MACd,IAAI,CAACA,GAAG,EAAE,OAAOT,EAAE,CAAC,IAAI,CAAC;MACzB,OAAO,IAAI,CAACG,GAAG,CAACgB,GAAG,CAAO,SAASV,GAAG,UAAUa,MAAM,EAAE,CAAC,CAACC,MAAM,EAAE;IACpE,CAAC,CAAC,CACH;EACH;;;uBAzCWtB,oBAAoB,EAAAuB,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,gBAAA,GAAAH,EAAA,CAAAC,QAAA,CAAAG,EAAA,CAAAC,WAAA;IAAA;EAAA;;;aAApB5B,oBAAoB;MAAA6B,OAAA,EAApB7B,oBAAoB,CAAA8B,IAAA;MAAAC,UAAA,EAFnB;IAAM;EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}