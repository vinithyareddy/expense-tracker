{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/fire/compat/firestore\";\nimport * as i2 from \"@angular/fire/compat/auth\";\nimport * as i3 from \"src/app/services/firestore-bill.service\";\nimport * as i4 from \"@angular/material/card\";\nimport * as i5 from \"@angular/material/table\";\nimport * as i6 from \"@angular/forms\";\nimport * as i7 from \"@angular/common\";\nfunction MonthlyComponent_th_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 12);\n    i0.ɵɵtext(1, \" Month \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction MonthlyComponent_td_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 13);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const summary_r10 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", summary_r10.monthYear, \" \");\n  }\n}\nfunction MonthlyComponent_th_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 12);\n    i0.ɵɵtext(1, \" Received \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction MonthlyComponent_td_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 13);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"currency\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const summary_r11 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(2, 1, summary_r11.received, \"USD\"), \" \");\n  }\n}\nfunction MonthlyComponent_th_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 12);\n    i0.ɵɵtext(1, \" Spent \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction MonthlyComponent_td_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 13);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"currency\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const summary_r12 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(2, 1, summary_r12.spent, \"USD\"), \" \");\n  }\n}\nfunction MonthlyComponent_th_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 12);\n    i0.ɵɵtext(1, \" Saved \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction MonthlyComponent_td_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 13);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"currency\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const summary_r13 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(2, 1, summary_r13.saved, \"USD\"), \" \");\n  }\n}\nfunction MonthlyComponent_tr_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 14);\n  }\n}\nfunction MonthlyComponent_tr_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 15);\n  }\n}\nconst _c0 = function () {\n  return [\"month\", \"received\", \"spent\", \"saved\"];\n};\nexport let MonthlyComponent = /*#__PURE__*/(() => {\n  class MonthlyComponent {\n    constructor(firestore, afAuth, firestoreBillService) {\n      this.firestore = firestore;\n      this.afAuth = afAuth;\n      this.firestoreBillService = firestoreBillService;\n      this.monthlySummaries = [];\n      this.filterText = '';\n    }\n    ngOnInit() {\n      this.afAuth.authState.subscribe(user => {\n        if (!user) {\n          console.warn('User not authenticated!');\n          return;\n        }\n        this.firestore.collection('expenses', ref => ref.where('userId', '==', user.uid)).valueChanges().subscribe(data => {\n          const grouped = {};\n          data.forEach(expense => {\n            const date = expense.date?.toDate?.() ?? new Date(expense.date);\n            if (isNaN(date.getTime())) return;\n            const key = `${date.toLocaleString('default', {\n              month: 'short'\n            })} ${date.getFullYear()}`;\n            const isIncome = expense.category.toLowerCase() === 'income';\n            if (!grouped[key]) {\n              grouped[key] = {\n                received: 0,\n                spent: 0\n              };\n            }\n            if (isIncome) {\n              grouped[key].received += expense.amount;\n            } else {\n              grouped[key].spent += expense.amount;\n            }\n          });\n          this.monthlySummaries = Object.entries(grouped).map(([monthYear, {\n            received,\n            spent\n          }]) => ({\n            monthYear,\n            received,\n            spent,\n            saved: received - spent\n          }));\n        });\n      });\n      this.firestoreBillService.billChanged$.subscribe(() => {\n        // ⏬ Call your logic again to refresh data\n        this.ngOnInit();\n      });\n    }\n    filteredSummaries() {\n      if (!this.filterText) return this.monthlySummaries;\n      const lower = this.filterText.toLowerCase();\n      return this.monthlySummaries.filter(summary => summary.monthYear.toLowerCase().includes(lower) || summary.received.toString().includes(lower) || summary.spent.toString().includes(lower) || summary.saved.toString().includes(lower));\n    }\n    static {\n      this.ɵfac = function MonthlyComponent_Factory(t) {\n        return new (t || MonthlyComponent)(i0.ɵɵdirectiveInject(i1.AngularFirestore), i0.ɵɵdirectiveInject(i2.AngularFireAuth), i0.ɵɵdirectiveInject(i3.FirestoreBillService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: MonthlyComponent,\n        selectors: [[\"app-monthly\"]],\n        decls: 21,\n        vars: 6,\n        consts: [[1, \"monthly-summary\"], [1, \"filter-bar-left\"], [\"type\", \"text\", \"placeholder\", \"\\uD83D\\uDD0D Search month, amount...\", 1, \"filter-input-left\", 3, \"ngModel\", \"ngModelChange\"], [\"mat-table\", \"\", 1, \"mat-elevation-z2\", \"full-width\", 3, \"dataSource\"], [\"matColumnDef\", \"month\"], [\"mat-header-cell\", \"\", 4, \"matHeaderCellDef\"], [\"mat-cell\", \"\", 4, \"matCellDef\"], [\"matColumnDef\", \"received\"], [\"matColumnDef\", \"spent\"], [\"matColumnDef\", \"saved\"], [\"mat-header-row\", \"\", 4, \"matHeaderRowDef\"], [\"mat-row\", \"\", 4, \"matRowDef\", \"matRowDefColumns\"], [\"mat-header-cell\", \"\"], [\"mat-cell\", \"\"], [\"mat-header-row\", \"\"], [\"mat-row\", \"\"]],\n        template: function MonthlyComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\");\n            i0.ɵɵtext(2, \"Monthly Summaries\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(3, \"div\", 1)(4, \"input\", 2);\n            i0.ɵɵlistener(\"ngModelChange\", function MonthlyComponent_Template_input_ngModelChange_4_listener($event) {\n              return ctx.filterText = $event;\n            });\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(5, \"mat-card\")(6, \"table\", 3);\n            i0.ɵɵelementContainerStart(7, 4);\n            i0.ɵɵtemplate(8, MonthlyComponent_th_8_Template, 2, 0, \"th\", 5);\n            i0.ɵɵtemplate(9, MonthlyComponent_td_9_Template, 2, 1, \"td\", 6);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵelementContainerStart(10, 7);\n            i0.ɵɵtemplate(11, MonthlyComponent_th_11_Template, 2, 0, \"th\", 5);\n            i0.ɵɵtemplate(12, MonthlyComponent_td_12_Template, 3, 4, \"td\", 6);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵelementContainerStart(13, 8);\n            i0.ɵɵtemplate(14, MonthlyComponent_th_14_Template, 2, 0, \"th\", 5);\n            i0.ɵɵtemplate(15, MonthlyComponent_td_15_Template, 3, 4, \"td\", 6);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵelementContainerStart(16, 9);\n            i0.ɵɵtemplate(17, MonthlyComponent_th_17_Template, 2, 0, \"th\", 5);\n            i0.ɵɵtemplate(18, MonthlyComponent_td_18_Template, 3, 4, \"td\", 6);\n            i0.ɵɵelementContainerEnd();\n            i0.ɵɵtemplate(19, MonthlyComponent_tr_19_Template, 1, 0, \"tr\", 10);\n            i0.ɵɵtemplate(20, MonthlyComponent_tr_20_Template, 1, 0, \"tr\", 11);\n            i0.ɵɵelementEnd()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(4);\n            i0.ɵɵproperty(\"ngModel\", ctx.filterText);\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"dataSource\", ctx.filteredSummaries());\n            i0.ɵɵadvance(13);\n            i0.ɵɵproperty(\"matHeaderRowDef\", i0.ɵɵpureFunction0(4, _c0));\n            i0.ɵɵadvance(1);\n            i0.ɵɵproperty(\"matRowDefColumns\", i0.ɵɵpureFunction0(5, _c0));\n          }\n        },\n        dependencies: [i4.MatCard, i5.MatTable, i5.MatHeaderCellDef, i5.MatHeaderRowDef, i5.MatColumnDef, i5.MatCellDef, i5.MatRowDef, i5.MatHeaderCell, i5.MatCell, i5.MatHeaderRow, i5.MatRow, i6.DefaultValueAccessor, i6.NgControlStatus, i6.NgModel, i7.CurrencyPipe],\n        styles: [\".filter-bar[_ngcontent-%COMP%]{margin-bottom:16px;display:flex;justify-content:flex-end}.filter-input[_ngcontent-%COMP%]{padding:8px 12px;border-radius:8px;border:1px solid #ccc;width:250px;font-size:14px;outline:none;transition:all .2s ease}.filter-input[_ngcontent-%COMP%]:focus{border-color:#5c6bc0;box-shadow:0 0 0 2px #5c6bc033}.monthly-summary[_ngcontent-%COMP%]{max-width:9000px;height:200%;margin:3rem auto;padding:2rem;background:#ffffff;border-radius:20px;box-shadow:0 20px 40px #0000000d}.monthly-summary[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2.8rem;font-weight:600;margin-bottom:1.5rem;color:#2f2e41;text-align:center}.monthly-summary[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{border-radius:20px;padding:1.5rem;background:#fcfcfc;box-shadow:0 15px 25px #0000000a}.monthly-summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:1rem}.monthly-summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:left;font-weight:600;padding:1rem;color:#555;background:#f5f5f5;border-bottom:1px solid #e0e0e0;font-size:1.3rem}.monthly-summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem;border-bottom:1px solid #eee;color:#050404;font-size:1rem}.monthly-summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:none}.monthly-summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(2){color:#2e7d32;font-weight:500;font-size:1rem}.monthly-summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(3){color:#d32f2f;font-weight:500;font-size:1rem}.monthly-summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(4){color:#000;font-weight:500;font-size:1rem}.monthly-summary[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;margin-bottom:16px;font-size:2rem;color:#2c2c2c}.monthly-summary[_ngcontent-%COMP%]   .filter-bar-left[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;margin:10px 0 20px}.monthly-summary[_ngcontent-%COMP%]   .filter-input-left[_ngcontent-%COMP%]{padding:10px 14px;border-radius:8px;border:2px solid #888;font-size:15px;width:280px;outline:none;transition:all .25s ease}.monthly-summary[_ngcontent-%COMP%]   .filter-input-left[_ngcontent-%COMP%]:focus{border-color:#333;box-shadow:0 0 0 4px #3333331a}.monthly-summary[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{padding:0}.monthly-summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-radius:10px;overflow:hidden}.monthly-summary[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f5f5f5;font-weight:600;padding:12px}.monthly-summary[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px}.monthly-summary[_ngcontent-%COMP%]   tr.mat-header-row[_ngcontent-%COMP%]{background-color:#f8f9fa}.monthly-summary[_ngcontent-%COMP%]   tr.mat-row[_ngcontent-%COMP%]:nth-child(2n){background-color:#fafafa}.monthly-summary[_ngcontent-%COMP%]   tr.mat-row[_ngcontent-%COMP%]:nth-child(odd){background-color:#fff}@media screen and (max-width: 768px){.monthly-summary[_ngcontent-%COMP%]{padding:1rem}.monthly-summary[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.6rem}.monthly-summary[_ngcontent-%COMP%]   .filter-bar-left[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;margin-bottom:1rem}.monthly-summary[_ngcontent-%COMP%]   .filter-input-left[_ngcontent-%COMP%]{width:100%;font-size:14px}.monthly-summary[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{padding:.5rem}.monthly-summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{font-size:.9rem}.monthly-summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .monthly-summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 8px;font-size:.9rem;word-break:break-word}.monthly-summary[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:1rem}}\"]\n      });\n    }\n  }\n  return MonthlyComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}