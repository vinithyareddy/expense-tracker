{"ast":null,"code":"import { Chart } from 'chart.js';\nimport ChartDataLabels from 'chartjs-plugin-datalabels'; // Updated import\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/fire/compat/firestore\";\nimport * as i2 from \"@angular/material/card\";\nimport * as i3 from \"@angular/common\";\nconst _c0 = [\"pieChart\"];\nconst _c1 = [\"barChart\"];\nconst _c2 = [\"lineChart\"];\n// Register chartjs plugins\nChart.register(ChartDataLabels);\nexport class HomeComponent {\n  constructor(firestore) {\n    this.firestore = firestore;\n    this.totalReceived = 0;\n    this.totalSpent = 0;\n    this.totalSaved = 0;\n    // Chart Data Variables\n    this.lineChartData = {\n      labels: [],\n      datasets: [{\n        data: [],\n        label: 'Savings',\n        fill: true,\n        tension: 0.4,\n        borderColor: '#4caf50',\n        backgroundColor: 'rgba(76, 175, 80, 0.2)'\n      }]\n    };\n    this.pieChartData = {\n      labels: [],\n      datasets: [{\n        data: [],\n        backgroundColor: ['#42a5f5', '#66bb6a', '#ffa726', '#ef5350', '#ab47bc', '#26c6da']\n      }]\n    };\n    this.barChartData = {\n      labels: [],\n      datasets: [{\n        data: [],\n        label: 'Spent',\n        backgroundColor: '#ff7043',\n        barPercentage: 0.4,\n        categoryPercentage: 0.6\n      }]\n    };\n    this.pieChartOptions = {\n      responsive: true,\n      plugins: {\n        legend: {\n          position: 'top'\n        },\n        datalabels: {\n          color: '#fff',\n          formatter: (value, ctx) => {\n            const data = ctx.chart.data.datasets[0].data;\n            const total = data.reduce((a, b) => a + b, 0);\n            return total ? (value / total * 100).toFixed(0) + '%' : '';\n          },\n          font: {\n            weight: 'bold',\n            size: 14\n          }\n        }\n      }\n    };\n    this.pieChartPlugins = [ChartDataLabels];\n    this.lineChartOptions = {\n      responsive: true,\n      maintainAspectRatio: false,\n      plugins: {\n        legend: {\n          position: 'top'\n        }\n      },\n      layout: {\n        padding: {\n          top: 10,\n          bottom: 10\n        }\n      }\n    };\n    this.barChartOptions = {\n      responsive: true,\n      maintainAspectRatio: false,\n      plugins: {\n        legend: {\n          position: 'top'\n        }\n      },\n      scales: {\n        x: {\n          ticks: {\n            font: {\n              size: 12\n            }\n          },\n          grid: {\n            display: false\n          }\n        },\n        y: {\n          beginAtZero: true,\n          ticks: {\n            font: {\n              size: 12\n            }\n          },\n          grid: {\n            color: 'rgba(0, 0, 0, 0.05)'\n          }\n        }\n      }\n    };\n  } // Removed CurrencyService, we're working with USD directly\n  ngOnInit() {\n    this.loadData();\n  }\n  ngOnChanges(changes) {\n    if (changes['pieChartData']) {\n      this.updateCharts();\n    }\n  }\n  loadData() {\n    this.firestore.collection('expenses').valueChanges().subscribe(data => {\n      let received = 0;\n      let spent = 0;\n      const monthlyMap = {};\n      const categoryMap = {};\n      data.forEach(exp => {\n        const date = exp.date?.toDate ? exp.date.toDate() : new Date(exp.date);\n        if (isNaN(date.getTime())) return;\n        const monthKey = `${date.toLocaleString('default', {\n          month: 'short'\n        })} ${date.getFullYear()}`;\n        const isIncome = exp.category.toLowerCase() === 'income';\n        if (!monthlyMap[monthKey]) {\n          monthlyMap[monthKey] = {\n            received: 0,\n            spent: 0\n          };\n        }\n        if (isIncome) {\n          received += exp.amount;\n          monthlyMap[monthKey].received += exp.amount;\n        } else {\n          spent += exp.amount;\n          monthlyMap[monthKey].spent += exp.amount;\n          // Pie chart - accumulate by category\n          if (!categoryMap[exp.category]) categoryMap[exp.category] = 0;\n          categoryMap[exp.category] += exp.amount;\n        }\n      });\n      // Amounts are already in USD, no need to convert\n      this.totalReceived = received;\n      this.totalSpent = spent;\n      this.totalSaved = this.totalReceived - this.totalSpent;\n      // Update LINE chart with savings month-wise\n      const monthLabels = Object.keys(monthlyMap);\n      const savingsData = monthLabels.map(key => monthlyMap[key].received - monthlyMap[key].spent);\n      this.lineChartData.labels = monthLabels;\n      this.lineChartData.datasets[0].data = savingsData;\n      // Update BAR chart with spent month-wise\n      const spentData = monthLabels.map(key => monthlyMap[key].spent);\n      this.barChartData.labels = monthLabels;\n      this.barChartData.datasets[0].data = spentData;\n      // Update PIE chart with spending by category\n      const pieLabels = Object.keys(categoryMap);\n      const pieData = pieLabels.map(key => categoryMap[key]);\n      this.pieChartData.labels = pieLabels;\n      this.pieChartData.datasets[0].data = pieData;\n      // Initialize charts (if not already initialized)\n      this.updateCharts();\n    });\n  }\n  updateCharts() {\n    if (this.pieChart && !this.pieChart.chart) {\n      this.pieChart.chart = new Chart(this.pieChart.nativeElement, {\n        type: 'pie',\n        data: this.pieChartData,\n        options: this.pieChartOptions\n      });\n    }\n    if (this.barChart && !this.barChart.chart) {\n      this.barChart.chart = new Chart(this.barChart.nativeElement, {\n        type: 'bar',\n        data: this.barChartData,\n        options: this.barChartOptions\n      });\n    }\n    if (this.lineChart && !this.lineChart.chart) {\n      this.lineChart.chart = new Chart(this.lineChart.nativeElement, {\n        type: 'line',\n        data: this.lineChartData,\n        options: this.lineChartOptions\n      });\n    }\n  }\n  static {\n    this.ɵfac = function HomeComponent_Factory(t) {\n      return new (t || HomeComponent)(i0.ɵɵdirectiveInject(i1.AngularFirestore));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: HomeComponent,\n      selectors: [[\"app-home\"]],\n      viewQuery: function HomeComponent_Query(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵviewQuery(_c0, 5);\n          i0.ɵɵviewQuery(_c1, 5);\n          i0.ɵɵviewQuery(_c2, 5);\n        }\n        if (rf & 2) {\n          let _t;\n          i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.pieChart = _t.first);\n          i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.barChart = _t.first);\n          i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.lineChart = _t.first);\n        }\n      },\n      features: [i0.ɵɵNgOnChangesFeature],\n      decls: 28,\n      vars: 12,\n      consts: [[1, \"dashboard-container\"], [1, \"summary-cards\"], [1, \"card\", \"received\"], [1, \"card\", \"spent\"], [1, \"card\", \"saved\"], [1, \"top-row\"], [1, \"chart\"], [\"lineChart\", \"\"], [\"pieChart\", \"\"], [1, \"bottom-row\"], [1, \"chart\", \"bar-chart\"], [\"barChart\", \"\"]],\n      template: function HomeComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"mat-card\", 2);\n          i0.ɵɵtext(3);\n          i0.ɵɵpipe(4, \"currency\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(5, \"mat-card\", 3);\n          i0.ɵɵtext(6);\n          i0.ɵɵpipe(7, \"currency\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(8, \"mat-card\", 4);\n          i0.ɵɵtext(9);\n          i0.ɵɵpipe(10, \"currency\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(11, \"div\", 5)(12, \"div\", 6)(13, \"h3\");\n          i0.ɵɵtext(14, \"Savings Growth (Line)\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(15, \"canvas\", null, 7);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(17, \"div\", 6)(18, \"h3\");\n          i0.ɵɵtext(19, \"Spending by Category (Pie)\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(20, \"canvas\", null, 8);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(22, \"div\", 9)(23, \"div\", 10)(24, \"h3\");\n          i0.ɵɵtext(25, \"Monthly Spend (Bar)\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(26, \"canvas\", null, 11);\n          i0.ɵɵelementEnd()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(3);\n          i0.ɵɵtextInterpolate1(\"Received: \", i0.ɵɵpipeBind2(4, 3, ctx.totalReceived, \"USD\"), \"\");\n          i0.ɵɵadvance(3);\n          i0.ɵɵtextInterpolate1(\"Spent: \", i0.ɵɵpipeBind2(7, 6, ctx.totalSpent, \"USD\"), \"\");\n          i0.ɵɵadvance(3);\n          i0.ɵɵtextInterpolate1(\"Saved: \", i0.ɵɵpipeBind2(10, 9, ctx.totalSaved, \"USD\"), \"\");\n        }\n      },\n      dependencies: [i2.MatCard, i3.CurrencyPipe],\n      styles: [\".dashboard-container[_ngcontent-%COMP%] {\\n  padding: 20px;\\n  background-color: #f9f9f9;\\n}\\n\\n.summary-cards[_ngcontent-%COMP%] {\\n  display: flex;\\n  justify-content: space-around;\\n  margin-bottom: 20px;\\n}\\n\\n.card[_ngcontent-%COMP%] {\\n  background-color: white;\\n  border-radius: 8px;\\n  padding: 20px;\\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\\n  text-align: center;\\n  flex: 1;\\n  margin: 0 10px;\\n  font-size: 1.5em; \\n\\n}\\n\\n.top-row[_ngcontent-%COMP%] {\\n  display: flex;\\n  justify-content: space-between;\\n  margin-bottom: 20px;\\n}\\n\\n.chart[_ngcontent-%COMP%] {\\n  background-color: white;\\n  border-radius: 8px;\\n  padding: 20px;\\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\\n  flex: 1;\\n  margin: 0 10px;\\n}\\n\\n.bottom-row[_ngcontent-%COMP%] {\\n  margin-top: 20px;\\n}\\n\\n.bar-chart[_ngcontent-%COMP%] {\\n  background-color: white;\\n  border-radius: 8px;\\n  padding: 20px;\\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\\n}\\n\\n\\n\\n@media (max-width: 768px) {\\n  .summary-cards[_ngcontent-%COMP%], .top-row[_ngcontent-%COMP%] {\\n    flex-direction: column;\\n  }\\n  .card[_ngcontent-%COMP%], .chart[_ngcontent-%COMP%] {\\n    margin: 10px 0;\\n  }\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvcGFnZXMvaG9tZS9ob21lLmNvbXBvbmVudC5zY3NzIiwid2VicGFjazovLy4vLi4vLi4vbXklMjBnaXRodWIlMjBwcm9qZWN0cy9leHBlbnNlLXRyYWNrZXIvc3JjL2FwcC9wYWdlcy9ob21lL2hvbWUuY29tcG9uZW50LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBK0NBO0VBQ0UsYUFBQTtFQUNBLHlCQUFBO0FDOUNGOztBRGlEQTtFQUNFLGFBQUE7RUFDQSw2QkFBQTtFQUNBLG1CQUFBO0FDOUNGOztBRGlEQTtFQUNFLHVCQUFBO0VBQ0Esa0JBQUE7RUFDQSxhQUFBO0VBQ0Esd0NBQUE7RUFDQSxrQkFBQTtFQUNBLE9BQUE7RUFDQSxjQUFBO0VBQ0EsZ0JBQUEsRUFBQSwrQkFBQTtBQzlDRjs7QURpREE7RUFDRSxhQUFBO0VBQ0EsOEJBQUE7RUFDQSxtQkFBQTtBQzlDRjs7QURpREE7RUFDRSx1QkFBQTtFQUNBLGtCQUFBO0VBQ0EsYUFBQTtFQUNBLHdDQUFBO0VBQ0EsT0FBQTtFQUNBLGNBQUE7QUM5Q0Y7O0FEaURBO0VBQ0UsZ0JBQUE7QUM5Q0Y7O0FEaURBO0VBQ0UsdUJBQUE7RUFDQSxrQkFBQTtFQUNBLGFBQUE7RUFDQSx3Q0FBQTtBQzlDRjs7QURpREEsMkJBQUE7QUFDQTtFQUNFO0lBQ0Usc0JBQUE7RUM5Q0Y7RURpREE7SUFDRSxjQUFBO0VDL0NGO0FBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyIvLyAuZGFzaGJvYXJkLWNvbnRhaW5lciB7XG4vLyAgIHBhZGRpbmc6IDFyZW07XG4vLyB9XG5cbi8vIC5zdW1tYXJ5LWNhcmRzIHtcbi8vICAgZGlzcGxheTogZmxleDtcbi8vICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1hcm91bmQ7XG4vLyAgIG1hcmdpbi1ib3R0b206IDJyZW07XG5cbi8vICAgLmNhcmQge1xuLy8gICAgIGZsZXg6IDE7XG4vLyAgICAgbWFyZ2luOiAwIDFyZW07XG4vLyAgICAgcGFkZGluZzogMXJlbTtcbi8vICAgICBmb250LXNpemU6IDEuMnJlbTtcbi8vICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4vLyAgIH1cblxuLy8gICAucmVjZWl2ZWQge1xuLy8gICAgIGJhY2tncm91bmQtY29sb3I6ICNlOGY1ZTk7XG4vLyAgICAgY29sb3I6ICMzODhlM2M7XG4vLyAgIH1cblxuLy8gICAuc3BlbnQge1xuLy8gICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmViZWU7XG4vLyAgICAgY29sb3I6ICNkMzJmMmY7XG4vLyAgIH1cblxuLy8gICAuc2F2ZWQge1xuLy8gICAgIGJhY2tncm91bmQtY29sb3I6ICNlM2YyZmQ7XG4vLyAgICAgY29sb3I6ICMxOTc2ZDI7XG4vLyAgIH1cbi8vIH1cblxuLy8gLnRvcC1yb3csIC5ib3R0b20tcm93IHtcbi8vICAgZGlzcGxheTogZmxleDtcbi8vICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1hcm91bmQ7XG4vLyAgIGZsZXgtd3JhcDogd3JhcDtcbi8vIH1cblxuLy8gLmNoYXJ0IHtcbi8vICAgd2lkdGg6IDQ1JTtcbi8vICAgbWluLXdpZHRoOiAzMDBweDtcbi8vICAgaGVpZ2h0OiAzMDBweDtcbi8vICAgbWFyZ2luLWJvdHRvbTogMnJlbTtcbi8vIH1cblxuXG4uZGFzaGJvYXJkLWNvbnRhaW5lciB7XG4gIHBhZGRpbmc6IDIwcHg7XG4gIGJhY2tncm91bmQtY29sb3I6ICNmOWY5Zjk7XG59XG5cbi5zdW1tYXJ5LWNhcmRzIHtcbiAgZGlzcGxheTogZmxleDtcbiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1hcm91bmQ7XG4gIG1hcmdpbi1ib3R0b206IDIwcHg7XG59XG5cbi5jYXJkIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7XG4gIGJvcmRlci1yYWRpdXM6IDhweDtcbiAgcGFkZGluZzogMjBweDtcbiAgYm94LXNoYWRvdzogMCAycHggNHB4IHJnYmEoMCwgMCwgMCwgMC4xKTtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xuICBmbGV4OiAxO1xuICBtYXJnaW46IDAgMTBweDtcbiAgZm9udC1zaXplOiAxLjVlbTsgLyogQWRqdXN0IGZvbnQgc2l6ZSBhcyBuZWVkZWQgKi9cbn1cblxuLnRvcC1yb3cge1xuICBkaXNwbGF5OiBmbGV4O1xuICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG4gIG1hcmdpbi1ib3R0b206IDIwcHg7XG59XG5cbi5jaGFydCB7XG4gIGJhY2tncm91bmQtY29sb3I6IHdoaXRlO1xuICBib3JkZXItcmFkaXVzOiA4cHg7XG4gIHBhZGRpbmc6IDIwcHg7XG4gIGJveC1zaGFkb3c6IDAgMnB4IDRweCByZ2JhKDAsIDAsIDAsIDAuMSk7XG4gIGZsZXg6IDE7XG4gIG1hcmdpbjogMCAxMHB4O1xufVxuXG4uYm90dG9tLXJvdyB7XG4gIG1hcmdpbi10b3A6IDIwcHg7XG59XG5cbi5iYXItY2hhcnQge1xuICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTtcbiAgYm9yZGVyLXJhZGl1czogOHB4O1xuICBwYWRkaW5nOiAyMHB4O1xuICBib3gtc2hhZG93OiAwIDJweCA0cHggcmdiYSgwLCAwLCAwLCAwLjEpO1xufVxuXG4vKiBSZXNwb25zaXZlIGFkanVzdG1lbnRzICovXG5AbWVkaWEgKG1heC13aWR0aDogNzY4cHgpIHtcbiAgLnN1bW1hcnktY2FyZHMsIC50b3Atcm93IHtcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICB9XG5cbiAgLmNhcmQsIC5jaGFydCB7XG4gICAgbWFyZ2luOiAxMHB4IDA7XG4gIH1cbn0iLCIuZGFzaGJvYXJkLWNvbnRhaW5lciB7XG4gIHBhZGRpbmc6IDIwcHg7XG4gIGJhY2tncm91bmQtY29sb3I6ICNmOWY5Zjk7XG59XG5cbi5zdW1tYXJ5LWNhcmRzIHtcbiAgZGlzcGxheTogZmxleDtcbiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1hcm91bmQ7XG4gIG1hcmdpbi1ib3R0b206IDIwcHg7XG59XG5cbi5jYXJkIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7XG4gIGJvcmRlci1yYWRpdXM6IDhweDtcbiAgcGFkZGluZzogMjBweDtcbiAgYm94LXNoYWRvdzogMCAycHggNHB4IHJnYmEoMCwgMCwgMCwgMC4xKTtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xuICBmbGV4OiAxO1xuICBtYXJnaW46IDAgMTBweDtcbiAgZm9udC1zaXplOiAxLjVlbTsgLyogQWRqdXN0IGZvbnQgc2l6ZSBhcyBuZWVkZWQgKi9cbn1cblxuLnRvcC1yb3cge1xuICBkaXNwbGF5OiBmbGV4O1xuICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XG4gIG1hcmdpbi1ib3R0b206IDIwcHg7XG59XG5cbi5jaGFydCB7XG4gIGJhY2tncm91bmQtY29sb3I6IHdoaXRlO1xuICBib3JkZXItcmFkaXVzOiA4cHg7XG4gIHBhZGRpbmc6IDIwcHg7XG4gIGJveC1zaGFkb3c6IDAgMnB4IDRweCByZ2JhKDAsIDAsIDAsIDAuMSk7XG4gIGZsZXg6IDE7XG4gIG1hcmdpbjogMCAxMHB4O1xufVxuXG4uYm90dG9tLXJvdyB7XG4gIG1hcmdpbi10b3A6IDIwcHg7XG59XG5cbi5iYXItY2hhcnQge1xuICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTtcbiAgYm9yZGVyLXJhZGl1czogOHB4O1xuICBwYWRkaW5nOiAyMHB4O1xuICBib3gtc2hhZG93OiAwIDJweCA0cHggcmdiYSgwLCAwLCAwLCAwLjEpO1xufVxuXG4vKiBSZXNwb25zaXZlIGFkanVzdG1lbnRzICovXG5AbWVkaWEgKG1heC13aWR0aDogNzY4cHgpIHtcbiAgLnN1bW1hcnktY2FyZHMsIC50b3Atcm93IHtcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICB9XG4gIC5jYXJkLCAuY2hhcnQge1xuICAgIG1hcmdpbjogMTBweCAwO1xuICB9XG59Il0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n    });\n  }\n}","map":{"version":3,"names":["Chart","ChartDataLabels","register","HomeComponent","constructor","firestore","totalReceived","totalSpent","totalSaved","lineChartData","labels","datasets","data","label","fill","tension","borderColor","backgroundColor","pieChartData","barChartData","barPercentage","categoryPercentage","pieChartOptions","responsive","plugins","legend","position","datalabels","color","formatter","value","ctx","chart","total","reduce","a","b","toFixed","font","weight","size","pieChartPlugins","lineChartOptions","maintainAspectRatio","layout","padding","top","bottom","barChartOptions","scales","x","ticks","grid","display","y","beginAtZero","ngOnInit","loadData","ngOnChanges","changes","updateCharts","collection","valueChanges","subscribe","received","spent","monthlyMap","categoryMap","forEach","exp","date","toDate","Date","isNaN","getTime","monthKey","toLocaleString","month","getFullYear","isIncome","category","toLowerCase","amount","monthLabels","Object","keys","savingsData","map","key","spentData","pieLabels","pieData","pieChart","nativeElement","type","options","barChart","lineChart","i0","ɵɵdirectiveInject","i1","AngularFirestore","selectors","viewQuery","HomeComponent_Query","rf","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵelement","ɵɵadvance","ɵɵtextInterpolate1","ɵɵpipeBind2"],"sources":["/Users/vinithyareddy/Desktop/projects/my github projects/expense-tracker/src/app/pages/home/home.component.ts","/Users/vinithyareddy/Desktop/projects/my github projects/expense-tracker/src/app/pages/home/home.component.html"],"sourcesContent":["import { Component, OnInit, OnChanges, SimpleChanges, ViewChild } from '@angular/core';\nimport { AngularFirestore } from '@angular/fire/compat/firestore';\nimport { ChartConfiguration, ChartOptions, Chart } from 'chart.js';\nimport { Expense } from '../expenses/expenses.component';\nimport ChartDataLabels from 'chartjs-plugin-datalabels'; // Updated import\n\n// Register chartjs plugins\nChart.register(ChartDataLabels);\n\n@Component({\n  selector: 'app-home',\n  templateUrl: './home.component.html',\n  styleUrls: ['./home.component.scss']\n})\nexport class HomeComponent implements OnInit, OnChanges {\n  totalReceived = 0;\n  totalSpent = 0;\n  totalSaved = 0;\n\n  // Chart Data Variables\n  lineChartData: ChartConfiguration<'line'>['data'] = {\n    labels: [],\n    datasets: [\n      {\n        data: [],\n        label: 'Savings',\n        fill: true,\n        tension: 0.4,\n        borderColor: '#4caf50',\n        backgroundColor: 'rgba(76, 175, 80, 0.2)'\n      }\n    ]\n  };\n\n  pieChartData: ChartConfiguration<'pie'>['data'] = {\n    labels: [],\n    datasets: [\n      {\n        data: [],\n        backgroundColor: ['#42a5f5', '#66bb6a', '#ffa726', '#ef5350', '#ab47bc', '#26c6da']\n      }\n    ]\n  };\n\n  barChartData: ChartConfiguration<'bar'>['data'] = {\n    labels: [],\n    datasets: [\n      {\n        data: [],\n        label: 'Spent',\n        backgroundColor: '#ff7043',\n        barPercentage: 0.4,\n        categoryPercentage: 0.6\n      }\n    ]\n  };\n\n  @ViewChild('pieChart') pieChart: any;\n  @ViewChild('barChart') barChart: any;\n  @ViewChild('lineChart') lineChart: any;\n\n  constructor(private firestore: AngularFirestore) {}  // Removed CurrencyService, we're working with USD directly\n\n  ngOnInit() {\n    this.loadData();\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (changes['pieChartData']) {\n      this.updateCharts();\n    }\n  }\n\n  loadData() {\n    this.firestore.collection<Expense>('expenses').valueChanges().subscribe((data: Expense[]) => {\n      let received = 0;\n      let spent = 0;\n\n      const monthlyMap: { [key: string]: { received: number; spent: number } } = {};\n      const categoryMap: { [category: string]: number } = {};\n      data.forEach(exp => {\n        const date = exp.date?.toDate ? exp.date.toDate() : new Date(exp.date);\n      \n        if (isNaN(date.getTime())) return;\n\n        const monthKey = `${date.toLocaleString('default', { month: 'short' })} ${date.getFullYear()}`;\n        const isIncome = exp.category.toLowerCase() === 'income';\n\n        if (!monthlyMap[monthKey]) {\n          monthlyMap[monthKey] = { received: 0, spent: 0 };\n        }\n\n        if (isIncome) {\n          received += exp.amount;\n          monthlyMap[monthKey].received += exp.amount;\n        } else {\n          spent += exp.amount;\n          monthlyMap[monthKey].spent += exp.amount;\n\n          // Pie chart - accumulate by category\n          if (!categoryMap[exp.category]) categoryMap[exp.category] = 0;\n          categoryMap[exp.category] += exp.amount;\n        }\n      });\n\n      // Amounts are already in USD, no need to convert\n      this.totalReceived = received;\n      this.totalSpent = spent;\n      this.totalSaved = this.totalReceived - this.totalSpent;\n\n      // Update LINE chart with savings month-wise\n      const monthLabels = Object.keys(monthlyMap);\n      const savingsData = monthLabels.map(key => monthlyMap[key].received - monthlyMap[key].spent);\n      this.lineChartData.labels = monthLabels;\n      this.lineChartData.datasets[0].data = savingsData;\n\n      // Update BAR chart with spent month-wise\n      const spentData = monthLabels.map(key => monthlyMap[key].spent);\n      this.barChartData.labels = monthLabels;\n      this.barChartData.datasets[0].data = spentData;\n\n      // Update PIE chart with spending by category\n      const pieLabels = Object.keys(categoryMap);\n      const pieData = pieLabels.map(key => categoryMap[key]);\n      this.pieChartData.labels = pieLabels;\n      this.pieChartData.datasets[0].data = pieData;\n\n      // Initialize charts (if not already initialized)\n      this.updateCharts();\n    });\n  }\n\n  updateCharts() {\n    if (this.pieChart && !this.pieChart.chart) {\n      this.pieChart.chart = new Chart(this.pieChart.nativeElement, {\n        type: 'pie',\n        data: this.pieChartData,\n        options: this.pieChartOptions\n      });\n    }\n    if (this.barChart && !this.barChart.chart) {\n      this.barChart.chart = new Chart(this.barChart.nativeElement, {\n        type: 'bar',\n        data: this.barChartData,\n        options: this.barChartOptions\n      });\n    }\n    if (this.lineChart && !this.lineChart.chart) {\n      this.lineChart.chart = new Chart(this.lineChart.nativeElement, {\n        type: 'line',\n        data: this.lineChartData,\n        options: this.lineChartOptions\n      });\n    }\n  }\n\n  pieChartOptions: ChartOptions<'pie'> = {\n    responsive: true,\n    plugins: {\n      legend: { position: 'top' },\n      datalabels: {\n        color: '#fff',\n        formatter: (value: number, ctx) => {\n          const data = ctx.chart.data.datasets[0].data as number[];\n          const total = data.reduce((a, b) => a + b, 0);\n          return total ? ((value / total) * 100).toFixed(0) + '%' : '';\n        },\n        font: { weight: 'bold' as const, size: 14 }\n      }\n    }\n  };\n\n  pieChartPlugins = [ChartDataLabels];\n\n  lineChartOptions: ChartConfiguration<'line'>['options'] = {\n    responsive: true,\n    maintainAspectRatio: false,\n    plugins: {\n      legend: { position: 'top' }\n    },\n    layout: { padding: { top: 10, bottom: 10 } }\n  };\n\n  barChartOptions: ChartConfiguration<'bar'>['options'] = {\n    responsive: true,\n    maintainAspectRatio: false,\n    plugins: {\n      legend: { position: 'top' }\n    },\n    scales: {\n      x: {\n        ticks: { font: { size: 12 } },\n        grid: { display: false }\n      },\n      y: {\n        beginAtZero: true,\n        ticks: { font: { size: 12 } },\n        grid: { color: 'rgba(0, 0, 0, 0.05)' }\n      }\n    }\n  };\n}\n","<div class=\"dashboard-container\">\n  <!-- Summary Cards -->\n  <div class=\"summary-cards\">\n    <mat-card class=\"card received\">Received: {{ totalReceived | currency: 'USD' }}</mat-card>\n    <mat-card class=\"card spent\">Spent: {{ totalSpent | currency: 'USD' }}</mat-card>\n    <mat-card class=\"card saved\">Saved: {{ totalSaved | currency: 'USD' }}</mat-card>\n  </div>\n\n  <!-- Charts Row 1: Line + Pie -->\n  <div class=\"top-row\">\n    <div class=\"chart\">\n      <h3>Savings Growth (Line)</h3>\n      <canvas #lineChart></canvas> <!-- Updated with ViewChild reference -->\n    </div>\n\n    <div class=\"chart\">\n      <h3>Spending by Category (Pie)</h3>\n      <canvas #pieChart></canvas> <!-- Updated with ViewChild reference -->\n    </div>\n  </div>\n\n  <!-- Bar Chart Row -->\n  <div class=\"bottom-row\">\n    <div class=\"chart bar-chart\">\n      <h3>Monthly Spend (Bar)</h3>\n      <canvas #barChart></canvas> <!-- Updated with ViewChild reference -->\n    </div>\n  </div>\n</div>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}